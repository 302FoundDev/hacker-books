---
import Layout from '../../layouts/Layout.astro'
import books from '../../content/mocks.json'
import { SHOW_BUY_BUTTON } from 'astro:env/server'
import BuyButton from '../../components/BuyButton.astro'


export function getStaticPaths() {
  return books.map((book) => ({
    params: { book: book.slug },
    props: { book }
}))
}

const { book } = Astro.props
const { title, semiDesc, img, url, slug } = book
---

<Layout title={`${title} - Hacker Books`}>

  <div class='flex gap-6 justify-center mt-24'>
    <aside class="flex flex-col">
      <a href='/' class='hover:underline opacity-70'>
        ‚Üê Go back
      </a>
      <img
        transition:name={`img-${slug}`}
        class='rounded-md border border-gray-700 transition max-w-64 h-auto' 
        src={img} 
        alt={title}
      />

      {
        SHOW_BUY_BUTTON && 
        <BuyButton buy={url.es}>
          Buy on Amazon
        </BuyButton>
      }

    </aside>

    <section class='flex flex-col gap-4 my-4'>
      <h1 transition:name={`title-${slug}`} class='text-2xl font-semibold'>
        {title}
      </h1>
      <p class='max-w-lg opacity-80'>
        {semiDesc}
      </p>
    </section>
  </div>

</Layout>
